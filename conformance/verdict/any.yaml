# =============================================================================
# OATF Conformance: compute_verdict — "any" Logic Mode
# Tests SDK compute_verdict with correlation.logic: any per SDK spec §4.5.
#
# any: error takes precedence, then any matched → exploited, else not_exploited.
# =============================================================================

- name: "One matched indicator — exploited"
  id: VERDICT-ANY-01
  input:
    correlation_logic: any
    indicators:
      - id: "ind-1"
      - id: "ind-2"
    verdicts:
      - indicator_id: "ind-1"
        result: matched
        timestamp: null
      - indicator_id: "ind-2"
        result: not_matched
        timestamp: null
  expected:
    result: exploited

- name: "None matched — not_exploited"
  id: VERDICT-ANY-02
  input:
    correlation_logic: any
    indicators:
      - id: "ind-1"
      - id: "ind-2"
    verdicts:
      - indicator_id: "ind-1"
        result: not_matched
        timestamp: null
      - indicator_id: "ind-2"
        result: not_matched
        timestamp: null
  expected:
    result: not_exploited

- name: "One error — error takes precedence"
  id: VERDICT-ANY-03
  input:
    correlation_logic: any
    indicators:
      - id: "ind-1"
      - id: "ind-2"
    verdicts:
      - indicator_id: "ind-1"
        result: matched
        timestamp: null
      - indicator_id: "ind-2"
        result: error
        timestamp: null
  expected:
    result: error

- name: "All skipped — not_exploited"
  id: VERDICT-ANY-04
  input:
    correlation_logic: any
    indicators:
      - id: "ind-1"
      - id: "ind-2"
    verdicts:
      - indicator_id: "ind-1"
        result: skipped
        timestamp: null
      - indicator_id: "ind-2"
        result: skipped
        timestamp: null
  expected:
    result: not_exploited

- name: "Mixed skipped and matched — exploited"
  id: VERDICT-ANY-05
  input:
    correlation_logic: any
    indicators:
      - id: "ind-1"
      - id: "ind-2"
    verdicts:
      - indicator_id: "ind-1"
        result: skipped
        timestamp: null
      - indicator_id: "ind-2"
        result: matched
        timestamp: null
  expected:
    result: exploited
